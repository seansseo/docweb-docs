"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[3132],{2323(e,r,n){n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"features/search","title":"Hybrid Search","description":"DocWeb uses a sophisticated hybrid search algorithm that combines vector similarity with BM25 keyword matching for optimal retrieval accuracy.","source":"@site/docs/features/search.md","sourceDirName":"features","slug":"/features/search","permalink":"/docs/docs/features/search","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/features/search.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Dex AI Chatbot","permalink":"/docs/docs/features/rag-chatbot"},"next":{"title":"Content Extraction","permalink":"/docs/docs/features/content-extraction"}}');var s=n(4848),t=n(8453);const c={},l="Hybrid Search",d={},a=[{value:"How It Works",id:"how-it-works",level:2},{value:"Vector Search",id:"vector-search",level:2},{value:"Embedding Generation",id:"embedding-generation",level:3},{value:"Similarity Calculation",id:"similarity-calculation",level:3},{value:"When It Excels",id:"when-it-excels",level:3},{value:"BM25 Keyword Search",id:"bm25-keyword-search",level:2},{value:"Parameters",id:"parameters",level:3},{value:"Formula",id:"formula",level:3},{value:"When It Excels",id:"when-it-excels-1",level:3},{value:"Field Weights",id:"field-weights",level:2},{value:"Score Merging",id:"score-merging",level:2},{value:"Normalization",id:"normalization",level:3},{value:"Deduplication",id:"deduplication",level:3},{value:"Result Format",id:"result-format",level:2},{value:"Performance",id:"performance",level:2},{value:"Best Practices for Queries",id:"best-practices-for-queries",level:2}];function o(e){const r={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.header,{children:(0,s.jsx)(r.h1,{id:"hybrid-search",children:"Hybrid Search"})}),"\n",(0,s.jsx)(r.p,{children:"DocWeb uses a sophisticated hybrid search algorithm that combines vector similarity with BM25 keyword matching for optimal retrieval accuracy."}),"\n",(0,s.jsx)(r.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"async function hybridSearch(query, appId, searchId, limit, apiKey, domain) {\n    // Run searches in parallel\n    const [vectorResults, keywordResults] = await Promise.all([\n        vectorSearch(query, domain),      // Gemini embeddings + cosine similarity\n        keywordSearch(query, searchId),   // BM25 scoring\n    ]);\n\n    // Merge and re-rank\n    return mergeAndRank(vectorResults, keywordResults, limit);\n}\n"})}),"\n",(0,s.jsx)(r.h2,{id:"vector-search",children:"Vector Search"}),"\n",(0,s.jsx)(r.p,{children:"Vector search finds semantically similar content by comparing embedding vectors."}),"\n",(0,s.jsx)(r.h3,{id:"embedding-generation",children:"Embedding Generation"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"Combine title + description + mainContent"}),"\n",(0,s.jsx)(r.li,{children:"Chunk text (4,000 characters, 400 overlap)"}),"\n",(0,s.jsx)(r.li,{children:"Generate embedding per chunk via Gemini text-embedding-004"}),"\n",(0,s.jsx)(r.li,{children:"Store 768-dimensional vectors in global collection"}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"similarity-calculation",children:"Similarity Calculation"}),"\n",(0,s.jsx)(r.p,{children:"Cosine similarity measures the angle between query and document vectors:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"similarity = (A \xb7 B) / (||A|| \xd7 ||B||)\n"})}),"\n",(0,s.jsx)(r.p,{children:"Range: -1 to 1 (higher = more similar)"}),"\n",(0,s.jsx)(r.h3,{id:"when-it-excels",children:"When It Excels"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:'Natural language questions: "How do I authenticate?"'}),"\n",(0,s.jsx)(r.li,{children:'Conceptual queries: "user permissions and access control"'}),"\n",(0,s.jsx)(r.li,{children:'Synonym handling: finds "authorization" when searching "permissions"'}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"bm25-keyword-search",children:"BM25 Keyword Search"}),"\n",(0,s.jsx)(r.p,{children:"BM25 (Best Matching 25) is a probabilistic ranking function that scores documents based on query term frequency."}),"\n",(0,s.jsx)(r.h3,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"const BM25_K1 = 1.5;        // Term frequency saturation\nconst BM25_B = 0.75;        // Length normalization\nconst AVG_DOC_LENGTH = 5000; // Average document length estimate\n"})}),"\n",(0,s.jsx)(r.h3,{id:"formula",children:"Formula"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"score = \u03a3 IDF(qi) \xd7 (f(qi, D) \xd7 (k1 + 1)) / (f(qi, D) + k1 \xd7 (1 - b + b \xd7 |D|/avgdl))\n"})}),"\n",(0,s.jsx)(r.p,{children:"Where:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"IDF(qi)"})," = Inverse document frequency of query term"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"f(qi, D)"})," = Term frequency in document"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"|D|"})," = Document length"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.code,{children:"avgdl"})," = Average document length"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"when-it-excels-1",children:"When It Excels"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Exact term matching: API names, error codes"}),"\n",(0,s.jsxs)(r.li,{children:["Code references: ",(0,s.jsx)(r.code,{children:"stripeClient.checkout.sessions.create"})]}),"\n",(0,s.jsx)(r.li,{children:'Technical terms: "OAuth2", "JWT", "WebSocket"'}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"field-weights",children:"Field Weights"}),"\n",(0,s.jsx)(r.p,{children:"Different fields are weighted based on their importance:"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Field"}),(0,s.jsx)(r.th,{children:"Weight"}),(0,s.jsx)(r.th,{children:"Rationale"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Title"}),(0,s.jsx)(r.td,{children:"5x"}),(0,s.jsx)(r.td,{children:"Page titles are highly descriptive"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Description"}),(0,s.jsx)(r.td,{children:"2x"}),(0,s.jsx)(r.td,{children:"Summaries capture key concepts"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Content"}),(0,s.jsx)(r.td,{children:"1x"}),(0,s.jsx)(r.td,{children:"Body text provides detailed context"})]})]})]}),"\n",(0,s.jsx)(r.h2,{id:"score-merging",children:"Score Merging"}),"\n",(0,s.jsx)(r.p,{children:"Final scores combine both search methods:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"finalScore = (0.7 * normalizedVectorScore) + (0.3 * normalizedKeywordScore);\n"})}),"\n",(0,s.jsx)(r.h3,{id:"normalization",children:"Normalization"}),"\n",(0,s.jsx)(r.p,{children:"Scores are normalized to 0-1 range before combining:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"normalizedScore = (score - minScore) / (maxScore - minScore);\n"})}),"\n",(0,s.jsx)(r.h3,{id:"deduplication",children:"Deduplication"}),"\n",(0,s.jsx)(r.p,{children:"When the same document appears in both result sets:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsx)(r.li,{children:"Keep the entry with the higher final score"}),"\n",(0,s.jsx)(r.li,{children:"Merge metadata from both entries"}),"\n"]}),"\n",(0,s.jsx)(r.h2,{id:"result-format",children:"Result Format"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-typescript",children:"interface SearchResult {\n    url: string;\n    title: string;\n    description: string;\n    chunkText: string;\n    relevanceScore: number;    // 0-1, combined score\n    vectorScore?: number;      // Raw vector similarity\n    keywordScore?: number;     // Raw BM25 score\n    domain: string;\n    docId: string;\n}\n"})}),"\n",(0,s.jsx)(r.h2,{id:"performance",children:"Performance"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Metric"}),(0,s.jsx)(r.th,{children:"Typical Value"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Vector search latency"}),(0,s.jsx)(r.td,{children:"50-200ms"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Keyword search latency"}),(0,s.jsx)(r.td,{children:"100-300ms"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Total hybrid search"}),(0,s.jsx)(r.td,{children:"150-400ms"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:"Results returned"}),(0,s.jsx)(r.td,{children:"Top 10"})]})]})]}),"\n",(0,s.jsx)(r.h2,{id:"best-practices-for-queries",children:"Best Practices for Queries"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Be specific"}),': "Stripe webhook signature verification" > "webhooks"']}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Use natural language"}),': "How do I handle errors?" works well']}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Include key terms"}),": Mix concepts with specific API names"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Ask follow-ups"}),": ",(0,s.jsx)(r.a,{href:"/docs/docs/features/rag-chatbot",children:"Dex"})," remembers conversation context"]}),"\n"]})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453(e,r,n){n.d(r,{R:()=>c,x:()=>l});var i=n(6540);const s={},t=i.createContext(s);function c(e){const r=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(t.Provider,{value:r},e.children)}}}]);