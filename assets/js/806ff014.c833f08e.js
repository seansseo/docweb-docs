"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[6002],{6258(e,n,s){s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>o,frontMatter:()=>a,metadata:()=>c,toc:()=>l});const c=JSON.parse('{"id":"features/caching","title":"Global Caching","description":"DocWeb uses a shared caching layer to optimize performance and reduce redundant crawling. All caching is global - benefiting all users of the platform.","source":"@site/docs/features/caching.md","sourceDirName":"features","slug":"/features/caching","permalink":"/docs/features/caching","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/features/caching.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Session Management","permalink":"/docs/features/sessions"},"next":{"title":"Use Cases","permalink":"/docs/use-cases/"}}');var i=s(4848),r=s(8453);const a={},d="Global Caching",t={},l=[{value:"Cache Types",id:"cache-types",level:2},{value:"Domain Cache",id:"domain-cache",level:3},{value:"Page Cache",id:"page-cache",level:3},{value:"Global Embeddings",id:"global-embeddings",level:3},{value:"Cache TTL",id:"cache-ttl",level:2},{value:"Cache Flow",id:"cache-flow",level:2},{value:"Discovery",id:"discovery",level:3},{value:"Scraping",id:"scraping",level:3},{value:"Cache Functions",id:"cache-functions",level:2},{value:"Cache Admin Panel",id:"cache-admin-panel",level:2},{value:"Cache Indicators",id:"cache-indicators",level:2},{value:"Cache Invalidation",id:"cache-invalidation",level:2},{value:"Performance Impact",id:"performance-impact",level:2},{value:"Best Practices",id:"best-practices",level:2}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"global-caching",children:"Global Caching"})}),"\n",(0,i.jsx)(n.p,{children:"DocWeb uses a shared caching layer to optimize performance and reduce redundant crawling. All caching is global - benefiting all users of the platform."}),"\n",(0,i.jsx)(n.h2,{id:"cache-types",children:"Cache Types"}),"\n",(0,i.jsx)(n.h3,{id:"domain-cache",children:"Domain Cache"}),"\n",(0,i.jsx)(n.p,{children:"Stores discovered URLs for entire domains."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Collection"}),": ",(0,i.jsx)(n.code,{children:"artifacts/global/domainCache/{domainHash}"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'interface DomainCache {\n    domain: string;               // e.g., "docs.stripe.com"\n    urls: string[];               // All discovered URLs\n    clusters: ClusterStats[];     // Cluster metadata\n    discoveryStats: DiscoveryStats;\n    source: "waterfall" | "cache";\n    discoveredAt: Timestamp;\n    expiresAt: Timestamp;         // 24-hour TTL\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Benefits"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Instant discovery when cache hit"}),"\n",(0,i.jsx)(n.li,{children:"No redundant robots.txt/sitemap fetching"}),"\n",(0,i.jsx)(n.li,{children:"Consistent URL classification across users"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"page-cache",children:"Page Cache"}),"\n",(0,i.jsx)(n.p,{children:"Stores scraped content per URL."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Collection"}),": ",(0,i.jsx)(n.code,{children:"artifacts/global/pageCache/{urlHash}"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface PageCache {\n    url: string;\n    domain: string;\n    title: string;\n    description: string;\n    mainContent: string;          // Markdown\n    contentHash: string;          // MD5 (12 chars)\n    scrapedAt: Timestamp;\n    expiresAt: Timestamp;         // 24-hour TTL\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Benefits"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Skip scraping already-cached pages"}),"\n",(0,i.jsx)(n.li,{children:"Faster content retrieval for chat"}),"\n",(0,i.jsx)(n.li,{children:"Content hash detects changes"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"global-embeddings",children:"Global Embeddings"}),"\n",(0,i.jsx)(n.p,{children:"Stores vector embeddings per URL chunk."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Collection"}),": ",(0,i.jsx)(n.code,{children:"artifacts/global/embeddings/{urlHash}_chunk{N}"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface GlobalEmbeddingDocument {\n    urlHash: string;              // SHA256 hash (16 chars)\n    url: string;\n    domain: string;               // For domain-scoped queries\n    chunkIndex: number;\n    chunkText: string;            // First 2000 chars\n    embedding: number[];          // 768-dim vector\n    title: string;\n    description: string;\n    searchIds: string[];          // Sessions referencing this\n    contentHash: string;          // MD5 (12 chars)\n    createdAt: Timestamp;\n    updatedAt: Timestamp;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Benefits"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Embeddings generated once, used by all"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"searchIds"})," tracks which sessions use each embedding"]}),"\n",(0,i.jsx)(n.li,{children:"Permanent storage (no TTL)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"cache-ttl",children:"Cache TTL"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Cache Type"}),(0,i.jsx)(n.th,{children:"TTL"}),(0,i.jsx)(n.th,{children:"Reason"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Domain Cache"}),(0,i.jsx)(n.td,{children:"24 hours"}),(0,i.jsx)(n.td,{children:"Sites update their structure infrequently"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Page Cache"}),(0,i.jsx)(n.td,{children:"24 hours"}),(0,i.jsx)(n.td,{children:"Content may change daily"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Embeddings"}),(0,i.jsx)(n.td,{children:"Permanent"}),(0,i.jsx)(n.td,{children:"Expensive to generate, rarely change"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"cache-flow",children:"Cache Flow"}),"\n",(0,i.jsx)(n.h3,{id:"discovery",children:"Discovery"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"User requests discovery\n    \u2193\nCheck domainCache for domain\n    \u2193\n[Cache Hit]                    [Cache Miss]\n    \u2193                              \u2193\nReturn cached URLs            Run Waterfall Discovery\n    \u2193                              \u2193\nCopy to user's session        Save to domainCache\n    \u2193                              \u2193\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2193\n            Display graph\n"})}),"\n",(0,i.jsx)(n.h3,{id:"scraping",children:"Scraping"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"User triggers scrape\n    \u2193\nCheck pageCache for URL\n    \u2193\n[Cache Hit]                    [Cache Miss]\n    \u2193                              \u2193\nReturn cached content         Fetch and parse page\n    \u2193                              \u2193\nCopy to user's session        Save to pageCache\n    \u2193                              \u2193\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                   \u2193\n          Generate embeddings (if needed)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"cache-functions",children:"Cache Functions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// Check domain cache\nconst cached = await getDomainCache(GLOBAL_CACHE_APP_ID, domain);\n\n// Save to domain cache\nawait setDomainCache(GLOBAL_CACHE_APP_ID, domain, {\n    urls, clusters, discoveryStats, source: "waterfall"\n});\n\n// Get cache age\nconst ageMs = getAgeMs(cachedDomain.discoveredAt);\n'})}),"\n",(0,i.jsx)(n.h2,{id:"cache-admin-panel",children:"Cache Admin Panel"}),"\n",(0,i.jsxs)(n.p,{children:["Administrators can manage the cache at ",(0,i.jsx)(n.code,{children:"/admin"}),":"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Action"}),(0,i.jsx)(n.th,{children:"Endpoint"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"List Domains"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"getCachedDomains"})}),(0,i.jsx)(n.td,{children:"View all cached domains"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"List Pages"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"getCachedPages"})}),(0,i.jsx)(n.td,{children:"View cached pages for domain"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Delete Domain"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"deleteCachedDomain"})}),(0,i.jsx)(n.td,{children:"Clear domain cache"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Delete Page"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"deleteCachedPage"})}),(0,i.jsx)(n.td,{children:"Clear single page cache"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"cache-indicators",children:"Cache Indicators"}),"\n",(0,i.jsx)(n.p,{children:"The UI shows cache status:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Indicator"}),(0,i.jsx)(n.th,{children:"Meaning"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:'source: "cache"'})}),(0,i.jsx)(n.td,{children:"Discovery used cached data"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"fromCache: true"})}),(0,i.jsx)(n.td,{children:"Response includes cache info"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"cacheAge"})}),(0,i.jsx)(n.td,{children:"Time since cache was created"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"cache-invalidation",children:"Cache Invalidation"}),"\n",(0,i.jsx)(n.p,{children:"Caches are invalidated when:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"TTL expires"}),": After 24 hours"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Content changes"}),": Content hash mismatch triggers re-scrape"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Manual deletion"}),": Via admin panel"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Domain deletion"}),": Removes all related cache entries"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"performance-impact",children:"Performance Impact"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Scenario"}),(0,i.jsx)(n.th,{children:"Without Cache"}),(0,i.jsx)(n.th,{children:"With Cache"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Discovery"}),(0,i.jsx)(n.td,{children:"5-30 seconds"}),(0,i.jsx)(n.td,{children:"< 1 second"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Scraping"}),(0,i.jsx)(n.td,{children:"1-5 seconds/page"}),(0,i.jsx)(n.td,{children:"< 100ms/page"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Embedding"}),(0,i.jsx)(n.td,{children:"2-5 seconds/chunk"}),(0,i.jsx)(n.td,{children:"Instant"})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"First discovery benefits everyone"}),": Your crawl populates cache for future users"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Check cache age"}),": Very recent caches may not reflect latest site changes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Force refresh"}),": Delete domain cache if you need fresh data"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Monitor cache size"}),": Large sites may have significant cache footprint"]}),"\n"]})]})}function o(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453(e,n,s){s.d(n,{R:()=>a,x:()=>d});var c=s(6540);const i={},r=c.createContext(i);function a(e){const n=c.useContext(r);return c.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),c.createElement(r.Provider,{value:n},e.children)}}}]);